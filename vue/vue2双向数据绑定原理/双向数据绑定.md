#### 对象

1. 核心点: Object.defineProperty
2. 默认Vue在初始化数据时，会给data中的属性使用Object.defineProperty重新定义所有属性，当页面取到对应属性时。会进行依赖收集(收集当前组件的watcher) 如果属性发生变化会通知相关以来进行更新操作。

#### 数组

1. 使用函数劫持的方式，重写了数组的方法
2. Vue将data中的数组，进行了原型链重写。指向了自己定义的数组原型方法，这样当调用数组api时，可以通知依赖更新，如果数组中包含着引用类型。会对数组中的引用类型再次进行监控。

## [双向绑定原理](https://juejin.im/post/6869908820353810445#heading-12)

双向绑定是视图变化会反映到数据，数据变化会反映到视图，`v-model` 就是个很好理解的例子。其实主要考查的还是响应式原理，响应式原理共包括3个主要成员，`Observer` 负责监听数据变化，`Dep` 负责依赖收集，`Watcher` 负责数据或视图更新，我们常说的收集依赖就是收集 `Watcher`。

响应式原理主要工作流程如下：

1. `Observer` 内使用 `Object.defineProperty` 劫持数据，为其设置 `set` 和 `get`。
2. 每个数据都会有自己的 `dep`。数据取值（compile处理fragment，将数据放进入的时候会拿数据,比如{{a}}这种正则匹配一下然后把data里的数据放进去）触发 `get` 函数，调用 `dep.depend` 收集依赖；数据更新触发 `set` 函数，调用 `dep.notify` 通知 `Watcher` 更新。
3. `Watcher` 接收到更新的通知，将这些通知加入到一个异步队列中，并且进行去重处理，等到所有同步操作完成后，再一次性更新视图。